Thymus.FACS <- read.csv("~/TabulaMuris_droplet/FACS/Thymus-counts.csv", row.names=1)
annotations.FACS<-read.csv("~/TabulaMuris_droplet/annotations_facs.csv")
label.Thymus.FACS<-annotations.FACS%>%filter(tissue == "Thymus")%>%select(c(cell_ontology_class,cell,free_annotation))
row.names(label.Thymus.FACS)<-label.Thymus.FACS[,2]
Thymus.FACS<-Thymus.FACS[,row.names(label.Thymus.FACS)]
pc.Thymus.FACS<-prcomp(t(Thymus.FACS))
scores.Thymus.FACS<-rare.cell.scores(pc.Thymus.FACS$x[,1:25])
tsne.Thymus.FACS<-Rtsne::Rtsne(pc.Thymus.FACS$x[,1:25],pca = F)
plt.Thymus.FACS<-scRCD.visualize(tsne = tsne.Thymus.FACS, scores = scores.Thymus.FACS,
                                 cell.type = label.Thymus.FACS[,3], frac = 0.1, method.name = "CSD")
plt.Thymus.FACS$plt.rare
plt.Thymus.FACS$plt.all
